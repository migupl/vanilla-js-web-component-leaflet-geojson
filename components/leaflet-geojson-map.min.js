/*!
  * leaflet-geojson-map (https://github.com/migupl/vanilla-js-web-component-leaflet-geojson)
  * Licensed under MIT (https://github.com/migupl/vanilla-js-web-component-leaflet-geojson/blob/master/LICENSE)
  */
(()=>{class e extends HTMLElement{#e={allowsAddMarker:this.hasAttribute("allows-add-marker"),addMarketText:this.getAttribute("add-marker-custom-text")||"Click to getting the map coordinates of this point at",customStyle:this.getAttribute("custom-style")||"",fitMapEffect:this.hasAttribute("fit-to-bounds"),flyMapEffect:this.hasAttribute("fly-to-bounds"),latitude:this.getAttribute("latitude")||51.505,longitude:this.getAttribute("longitude")||-.09,tileCopyright:this.getAttribute("tile-copyright")||(this.hasAttribute("tile-server")?"":'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'),tileServer:this.getAttribute("tile-server")||"https://tile.openstreetmap.org/{z}/{x}/{y}.png",maxZoom:this.getAttribute("max-zoom")||19,zoom:this.getAttribute("zoom")||13};#t=new WeakMap;constructor(){super(),this.#e.shadowRoot=this.attachShadow({mode:"closed"}),this.#a()}connectedCallback(){const e=e=>this.#e.shadowRoot.appendChild(e),t=this.#o.getWcStyleNode();e(t);const[a,o]=this.#e.customStyle.split(":"),l=this.#o.getStyleNodeFrom(o);e(l);this.#o.getMarkerClusterStyleNode().forEach((t=>e(t)));const n=this.#o.getLeafletStyleNode();e(n);const s=this.#o.getWcNode();a&&s.classList.add(a),e(s),this.#l(s)}#l=e=>{const t=(()=>{const e=(e,t)=>{const a=new CustomEvent(e,{bubbles:!0,composed:!0,detail:t});this.#e.shadowRoot.dispatchEvent(a)};return{added:t=>{e("x-leaflet-map:marker-pointed-out",{latlng:t})},removed:t=>{e("x-leaflet-map:marker-removed",{feature:t})}}})(),a={center:new L.LatLng(this.#e.latitude,this.#e.longitude),zoom:this.#e.zoom,layers:L.tileLayer(this.#e.tileServer,{maxZoom:this.#e.maxZoom,attribution:this.#e.tileCopyright})},o=L.map(e,a);this.#e.allowsAddMarker&&(e=>{const a=a=>{const{lat:o,lng:l}=a;let n=document.createElement("button");return n.style="background-color: blue; border: none; border-radius: 8px; color: white; padding: 10px;",n.innerText=`${this.#e.addMarketText}\nlatitude: ${o},\nlongitude: ${l}`,n.onclick=o=>{t.added(a),e.closePopup()},n};e.addEventListener("contextmenu",(t=>{const{latlng:o}=t,l=a(o);e.openPopup(l,o,{closeButton:!1})}))})(o),this.#t.set(this,{map:o,tile:a.layers,markers:null,onMarkerRemoved:({layer:e,markers:a,removingLatLng:o,mapInfo:l})=>{const{feature:n}=e;if(n){let{map:s,latLngPoints:r}=l;const i=L.latLng(o),c=r.filter((e=>!e.equals(i,0)));a.removeLayer(e),t.removed(n),l.latLngPoints=c,c.length&&this.#n(s,c)}},latLngPoints:[]})};#a=()=>{const e=e=>e===this.id;["x-leaflet-map-clear","x-leaflet-map-geojson-add","x-leaflet-map-geojson:include-latlng-to-fly"].forEach((e=>this.addEventListener(e,(e=>e.stopPropagation())))),this.addEventListener("x-leaflet-map-clear",(t=>{const a=t.target;if(e(a.id)){const{map:e,tile:t}=this.#t.get(a);e.eachLayer((function(a){a!==t&&a.removeFrom(e)}))}})),this.addEventListener("x-leaflet-map-geojson-add",(t=>{const a=t.target;if(e(a.id)){const e=this.#t.get(a),{geojson:o}=t.detail;this.#s.addTo(o,a,e)}})),this.addEventListener("x-leaflet-map-geojson:include-latlng-to-fly",(t=>{const a=t.target;if(e(a.id)){const{map:e,latLngPoints:o}=this.#t.get(a),{latlng:{lng:l,lat:n}}=t.detail,s=L.latLng(n,l);o.push(s),this.#n(e,o)}}))};#n=(e,t)=>{this.#e.fitMapEffect?e.fitBounds(t):this.#e.flyMapEffect&&e.flyToBounds(t)};#s=(e=>{const t=(e,t,a)=>{const{map:o,markers:l}=a;e&&l.addLayer(i(e,t)).addTo(o)},a=(e,t,a)=>{const{map:o,markers:l}=a;e&&l.addLayer(c(e,t)).addTo(o)},o=e=>t=>{const a=L.GeoJSON.coordsToLatLng(t);return(t=>{e.dispatchEvent(new CustomEvent("x-leaflet-map-geojson:include-latlng-to-fly",{bubbles:!0,composed:!0,detail:{latlng:t}}))})(a),a},l=e=>"FeatureCollection"===e.type?e.features:[e],n=e=>{const t=L.markerClusterGroup();return t.on("dblclick",(a=>{const{layer:o,latlng:l}=a;(({markers:e,layer:t,latlng:a,mapInfo:o})=>{const l=t.getPopup()._content;let n=document.createElement("button");n.style="background-color: red; border: none; border-radius: 8px; color: white; padding: 10px;",n.innerText="Delete Marker",n.onclick=()=>o.onMarkerRemoved({layer:t,markers:e,removingLatLng:a,mapInfo:o}),d(t,n).openPopup(),t.getPopup().on("remove",(()=>{d(t,l),t.getPopup().off("remove")}))})({markers:t,layer:o,latlng:l,mapInfo:e})})),t},s=e=>e.reduce(((e,t)=>{const a="Point"==t.geometry.type?"points":"polygons";return e[a]=e[a]||[],e[a].push(t),e}),Object.create(null)),r=(e,t)=>{e?.properties?.popupContent&&d(t,e.properties.popupContent)},i=(t,a)=>L.geoJSON(t,{coordsToLatLng:o(a),onEachFeature:r,pointToLayer:function(t,a){let o;const l=t?.properties?.radius;if(l){const e={...t.properties};delete e.style,delete e.draggable,o=L.circle(a,e)}else{const l=t?.properties?.draggable||!1,n={icon:L.icon(t?.properties?.icon||e),draggable:l};o=L.marker(a,n),l&&o.on("dragend",(e=>{const t=e.target,{lat:a,lng:o}=t.getLatLng(),l=new L.LatLng(a,o);t.setLatLng(l)}))}return o},style:e=>e?.properties?.style}),c=(t,a)=>L.geoJSON(t,{coordsToLatLng:o(a),onEachFeature:r,pointToLayer:function(t,a){const o={icon:L.icon(t?.properties?.icon||e)};return L.marker(a,o)},style:e=>e?.properties?.style}),d=(e,t)=>e.bindPopup(t,{closeButton:!1});return{addTo:(e,o,r)=>{r.markers||(r.markers=n(r));const i=l(e),{points:c,polygons:d}=s(i);t(c,o,r),a(d,o,r)}}})({iconUrl:"https://unpkg.com/leaflet@1.9.3/dist/images/marker-icon.png",shadowUrl:"https://unpkg.com/leaflet@1.9.3/dist/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});#o=(()=>{const e=e=>fetch(e).then((e=>e.text())).catch((e=>{const t=`An error has occured: ${response.status}`;throw new Error(t)}));return{getWcStyleNode:()=>{const e=document.createElement("style");return e.innerText=":host {display: block;}#map {position: absolute;inset: 0px;top: 0;right: 0;bottom: 0;left: 0;}.leaflet-container {max-width: 100%;max-height: 100%;}.leaflet-control-zoom {display: none;}",e},getStyleNodeFrom:t=>{const a=document.createElement("style");return t&&e(t).then((e=>a.innerText=e)),a},getWcNode:()=>{const e=document.createElement("div");return e.id="map",e.className="leaflet-container leaflet-touch leaflet-fade-anim leaflet-grab leaflet-touch-drag leaflet-touch-zoom",e.tabIndex="0",e.innerHTML='<div class="leaflet-pane leaflet-map-pane" style="transform: translate3d(0px, 0px, 0px);"><div class="leaflet-pane leaflet-tile-pane"><div class="leaflet-layer " style="z-index: 1; opacity: 1;"><div class="leaflet-tile-container leaflet-zoom-animated"style="z-index: 19; transform: translate3d(0px, 0px, 0px) scale(1);"></div></div></div><div class="leaflet-pane leaflet-overlay-pane"></div><div class="leaflet-pane leaflet-shadow-pane"></div><div class="leaflet-pane leaflet-marker-pane"></div><div class="leaflet-pane leaflet-tooltip-pane"></div><div class="leaflet-pane leaflet-popup-pane"></div><div class="leaflet-proxy leaflet-zoom-animated"style="transform: translate3d(1048050px, 697379px, 0px) scale(4096);"></div></div><div class="leaflet-control-container"><div class="leaflet-top leaflet-left"><div class="leaflet-control-zoom leaflet-bar leaflet-control"><a class="leaflet-control-zoom-in" href="#"title="Zoom in" role="button" aria-label="Zoom in" aria-disabled="false"><spanaria-hidden="true">+</span></a><a class="leaflet-control-zoom-out" href="#" title="Zoom out"role="button" aria-label="Zoom out" aria-disabled="false"><span aria-hidden="true">−</span></a></div></div><div class="leaflet-top leaflet-right"></div><div class="leaflet-bottom leaflet-left"></div><div class="leaflet-bottom leaflet-right"><div class="leaflet-control-attribution leaflet-control"><a href="https://leafletjs.com"title="A JavaScript library for interactive maps">Leaflet</a> <span aria-hidden="true">|</span> © <ahref="http://www.openstreetmap.org/copyright">OpenStreetMap</a></div></div></div>',e},getLeafletStyleNode:()=>{const t=document.createElement("style");return e("https://unpkg.com/leaflet@1.9.4/dist/leaflet.css").then((e=>t.innerText=e)),t},getMarkerClusterStyleNode:()=>{const t=t=>{const a=document.createElement("style");return e(`https://unpkg.com/leaflet.markercluster@1.5.3/dist/${t}`).then((e=>a.innerText=e)),a};return[t("MarkerCluster.Default.css"),t("MarkerCluster.css")]}}})()}let t=(()=>{const e="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js",t="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=";let a=document.createElement("script");return a.src=e,a.integrity=t,a.crossOrigin="",a.async="false",a})();t.onload=t=>{customElements.define("leaflet-geojson-map",e);const a=(()=>{let e=document.createElement("script");return e.src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js",e.crossOrigin="",e.async="false",e})();document.body.appendChild(a)},document.body.append(t)})();
